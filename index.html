<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>è§£æƒ‘å°ç²¾éˆ</title>

    <link rel="stylesheet" type="text/css" href="style.css">

    <script src="libraries/p5.min.js"></script>
    <script src="libraries/p5.sound.min.js"></script>
    <style>
      /* éŠæˆ²é–‹å§‹èªªæ˜é é¢çš„æ¨£å¼ */
      #start-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        /* ä½¿ç”¨èƒŒæ™¯åœ–ç‰‡ä¸¦ç–ŠåŠ åŠé€æ˜é»‘è‰²é®ç½©ï¼Œç¢ºä¿æ–‡å­—æ¸…æ™° */
        background: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('èƒŒæ™¯/1.jpg');
        background-size: cover;
        background-position: center;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        color: white;
        z-index: 9999; /* ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
        font-family: sans-serif;
      }
      #start-screen h1 {
        font-size: 5rem;
        margin-bottom: 20px;
        text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.8);
      }
      /* é€šç”¨æŒ‰éˆ•æ¨£å¼ */
      #start-screen button {
        padding: 15px 40px;
        font-size: 1.5rem;
        background-color: #4CAF50;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background 0.3s;
        margin: 10px;
      }
      #start-screen button:hover {
        background-color: #45a049;
      }
      /* å…§å®¹å€å¡Šæ¨£å¼ */
      #start-content, #instruction-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
      }
      /* èªªæ˜æ–‡å­—å€å¡Š */
      .instructions-text {
        background-color: rgba(255, 255, 255, 0.1); /* è¼•å¾®äº®åº•è®“æ–‡å­—æ›´æ¸…æ¥š */
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 20px;
        max-width: 600px;
        text-align: left;
        line-height: 1.6;
        font-size: 1.1rem;
      }
      .instructions-text h3 {
        color: #FFD700; /* é‡‘é»ƒè‰²æ¨™é¡Œ */
        margin-top: 15px;
        margin-bottom: 10px;
        border-bottom: 1px solid rgba(255,255,255,0.3);
        padding-bottom: 5px;
      }
      /* éŠæˆ²ä¸­èªªæ˜æŒ‰éˆ•çš„æ¨£å¼ */
      #ingame-instruction-btn {
        position: fixed;
        bottom: 20px;
        left: 20px;
        z-index: 9998; /* ç¢ºä¿åœ¨èªªæ˜é é¢ä¸‹æ–¹ */
        width: 50px;
        height: 50px;
        background-color: rgba(0, 100, 0, 0.8);
        color: white;
        border: 2px solid white;
        border-radius: 50%;
        cursor: pointer;
        font-size: 1.8rem;
        font-weight: bold;
        line-height: 46px;
        text-align: center;
        padding: 0;
      }
    </style>
  </head>

  <body>
    <!-- éŠæˆ²é–‹å§‹èªªæ˜å€å¡Š -->
    <div id="start-screen">
      <!-- ä¸»é¸å–® -->
      <div id="start-content">
        <h1>è§£æƒ‘å°ç²¾éˆ</h1>
        <div>
          <button id="instruction-btn">éŠæˆ²èªªæ˜</button>
          <button id="start-btn">é–‹å§‹éŠæˆ²</button>
        </div>
      </div>

      <!-- èªªæ˜é é¢ (é è¨­éš±è—) -->
      <div id="instruction-content" style="display: none;">
        <h2>éŠæˆ²èªªæ˜</h2>
        <div class="instructions-text">
          <h3>ğŸ“– æ•…äº‹èƒŒæ™¯</h3>
          <p>
            åœ¨ç¥ç§˜çš„çŸ¥è­˜æ£®æ—ä¸­ï¼Œä¸€ä½å……æ»¿å¥½å¥‡å¿ƒçš„å°ç²¾éˆæ­£åœ¨å°‹æ‰¾å‚³èªªä¸­çš„ã€Œç¥å¥‡èŠè­˜èµ·å¸ã€ã€‚<br>
            ç„¶è€Œï¼Œæ£®æ—è£¡å……æ»¿äº†æŒ‘æˆ°ï¼ä½ å¿…é ˆé€šéçŸ¥è­˜å®ˆé–€å“¡å°ç´…çš„éš¨å ‚æ¸¬é©—ã€å°‹æ±‚æ©˜è²“é†«ç”Ÿçš„æ²»ç™’å”åŠ©ï¼Œä¸¦æ“Šé€€è©¦åœ–é˜»æ’“çš„æ—è›‹é»‘å–µã€‚<br>
            æº–å‚™å¥½é‹ç”¨ä½ çš„æ™ºæ…§èˆ‡åæ‡‰åŠ›ï¼Œå¹«åŠ©å°ç²¾éˆå®Œæˆé€™å ´å†’éšªäº†å—ï¼Ÿ
          </p>
          
          <h3>ğŸ® æ“æ§æ–¹å¼</h3>
          <p>
            <strong>W, A, S, D</strong>ï¼šç§»å‹•è§’è‰²<br>
            <strong>ç©ºç™½éµ (Space)</strong>ï¼šæ”»æ“Š / äº’å‹•
          </p>
          
          <h3>ğŸ‘¥ è§’è‰²ä»‹ç´¹</h3>
          <p>
            <strong>ğŸ± æ©˜è²“ï¼š</strong> æä¾›å›è¡€æœå‹™ï¼Œå—å‚·äº†å¯ä»¥æ‰¾ç‰ ã€‚<br>
            <strong>ğŸ‘§ å°ç´…ï¼š</strong> çŸ¥è­˜å®ˆé–€å“¡ï¼Œç­”éŒ¯å•é¡Œæœƒæ‰£è¡€å–”ï¼<br>
            <strong>ğŸ¦ å•¾å•¾ï¼š</strong> ç©ºä¸­çš„å°å¹«æ‰‹ï¼Œæ¸¬é©—æ™‚å¯ä»¥æ‰¾ç‰ è¦æç¤ºã€‚<br>
            <strong>ğŸ˜ˆ é»‘å–µï¼š</strong> ä½ çš„å°æ‰‹ï¼Œå°å¿ƒæ‡‰å°ï¼
          </p>
        </div>
        <button id="back-btn">è¿”å›</button>
      </div>
    </div>

    <!-- éŠæˆ²ä¸­é–‹å•Ÿèªªæ˜çš„æŒ‰éˆ• -->
    <button id="ingame-instruction-btn" style="display: none;">?</button>

    <script src="sketch.js"></script>
    <script>
      const startScreen = document.getElementById('start-screen');
      const startContent = document.getElementById('start-content');
      const instructionContent = document.getElementById('instruction-content');
      const ingameInstructionBtn = document.getElementById('ingame-instruction-btn');
      const backBtn = document.getElementById('back-btn');

      let gameHasStarted = false;

      function closeInstructionsAndResumeGame() {
        startScreen.style.display = 'none';
        ingameInstructionBtn.style.display = 'block';
        if (typeof loop === 'function') {
          loop(); // ç¹¼çºŒéŠæˆ²
        }
      }

      // è™•ç†é–‹å§‹æŒ‰éˆ•çš„é»æ“Šäº‹ä»¶
      document.getElementById('start-btn').addEventListener('click', function() {
        // éš±è—èªªæ˜é é¢
        startScreen.style.display = 'none';
        ingameInstructionBtn.style.display = 'block';
        gameHasStarted = true;
        
        // å¦‚æœéœ€è¦åœ¨é»æ“Šå¾Œæ‰é–‹å§‹æ’­æ”¾éŸ³æ¨‚æˆ–å•Ÿå‹•éŠæˆ²è¿´åœˆï¼Œ
        // å¯ä»¥åœ¨é€™è£¡å‘¼å«ç›¸é—œçš„ p5.js å‡½æ•¸ï¼Œä¾‹å¦‚ loop() æˆ– userStartAudio();
        if (typeof userStartAudio === 'function') {
          userStartAudio();
        }
        if (typeof loop === 'function') {
          loop();
        }
      });

      // é»æ“Šã€ŒéŠæˆ²èªªæ˜ã€
      document.getElementById('instruction-btn').addEventListener('click', function() {
        startContent.style.display = 'none';
        instructionContent.style.display = 'flex';
        backBtn.textContent = 'è¿”å›ä¸»é¸å–®';
      });

      // é»æ“ŠéŠæˆ²ä¸­çš„èªªæ˜æŒ‰éˆ•
      ingameInstructionBtn.addEventListener('click', function() {
        startScreen.style.display = 'flex';
        instructionContent.style.display = 'flex';
        startContent.style.display = 'none';
        ingameInstructionBtn.style.display = 'none';
        backBtn.textContent = 'è¿”å›éŠæˆ²';
        if (typeof noLoop === 'function') {
          noLoop(); // æš«åœéŠæˆ²
        }
      });

      // é»æ“Šèªªæ˜é ä¸­çš„è¿”å›æŒ‰éˆ•
      backBtn.addEventListener('click', function() {
        if (gameHasStarted) {
          closeInstructionsAndResumeGame();
        } else {
          instructionContent.style.display = 'none';
          startContent.style.display = 'flex';
        }
      });

      // é»æ“Šèªªæ˜é é¢èƒŒæ™¯ä»»æ„è™•é—œé–‰ (åƒ…åœ¨éŠæˆ²é–‹å§‹å¾Œ)
      startScreen.addEventListener('click', function(event) {
        if (gameHasStarted && event.target === startScreen) {
          closeInstructionsAndResumeGame();
        }
      });
    </script>
  </body>
</html>
